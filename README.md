Ключевые этапы решения:
1. E5 эмбэдинги для IR между названием и запросом (на описание не хватило времени, так бы я сделал ElasticSearch с BM25, так запросы короткие и без семантики, нам нужно ловить только ключевые слова)
2. В ходе EDA нашел закономерности в данных, добавил почти 20 фич
3. Обучался на реранкере LightGBM

Добавил e5-base эмбэдинги для описаний, это уменьшило качество (в ветке e5-light)
Добавил кастомную метрику для decay ndcg, тоже уменьшило качество

Лучшим решением было бы в LLM подать примеры по все категориям, определить названия категорий

Потом для каждой категории определить основные характеристики ( допустим для одежды бренд, цвет и тд.)

Вытащить из всех названий для каждой категории специальные фичи (с помощью NER/LLM/Natasha/сделать словарь и тд) и по совпадениям сделать бинарные признаки

Кластеризовать бренды которые чаще ведут к покупке и тд

Поверх построить кроссенкодер

Эмбэдинги тут не очень помогут, так как запросы очень пустые и как следствие косинусное расстояние почти не дает информации

Нужно автоматически вытаскивать фичи из названий и жестко их сравнивать

К сожалению, у меня не было вычислительных ресурсов чтобы проводить так много экспериментов


Пайплайн  ноутбуков: E5 ->features->reranker
