Как запускать для воспроизведения: e5 -> cosine -> features -> features_new -> reranker

Если хотите посмотреть решение с большим количеством фичей, подходов и тд, но давшее меньший скор, можете посмотреть векту e5-light

Ключевые этапы решения:
1. E5 эмбэдинги для IR между названием и запросом
2. В ходе EDA нашел закономерности в данных, добавил почти 20 фич
3. Обучался на реранкере LightGBM

Что пробовал, но это ухудшило качество:
1. Добавил e5-base эмбэдинги для описаний, это уменьшило качество (в ветке e5-light)
2. Добавил кастомную метрику для decay ndcg, тоже уменьшило качество
3. Сделал токенизацию + лемматизацию и разбил на n grams, считал покрытие, полное совпадение с запросом

Что бы я сделал, имея больше вычислительных ресурсов:

Эмбэдинги тут не очень помогут, так как запросы очень пустые и как следствие косинусное расстояние почти не дает информации

Лучшим решением было бы в LLM подать примеры по всем категориям, определить названия категорий

Потом для каждой категории определить основные характеристики ( допустим для одежды бренд, цвет и тд.)

Вытащить из всех названий для каждой категории специальные фичи (с помощью NER/LLM/Natasha/сделать словарь и тд) и по совпадениям сделать бинарные признаки

Кластеризовать бренды которые чаще ведут к покупке и тд

Поверх построить кроссенкодер

Нужно автоматически вытаскивать фичи из названий и жестко их сравнивать

К сожалению, у меня не было вычислительных ресурсов чтобы проводить так много экспериментов


Пайплайн  ноутбуков: E5 ->features->reranker
